var express = require('express')
var ipfsAPI = require('ipfs-api')
var multer = require('multer')
var util = require('util')
var path=require('path')
var fs = require('fs')
var bodyparser = require ('body-parser')
var Web3 = require('web3')
var mime = require("mime");

var app = express()
var ipfs = ipfsAPI('/ip4/127.0.0.1/tcp/5001');
var router = express.Router();
var config = require('config');
console.log("Environment is:" + config.get('env') );

if(config.get('env') == "prod" )
{
  var contract = require('./UserAccessControlContract.js')
}
else{
 var contract = require('./UserAccessControlContractqa.js') 
}



//Simple implementation of logging to both console and log file by overwriting the console.log function.
//For production implementation, use Winston.
var log_file = fs.createWriteStream(config.get('logpath'), {flags : 'a'});
var log_stdout = process.stdout;
console.log = function(d) { //
  log_file.write(util.format(d) + '\n');
  log_stdout.write(util.format(d) + '\n');
};

process.on('uncaughtException', function (err) {
  console.error(err.stack);
  console.log("Node NOT Exiting...");  
});


//set defaults:
var const_gas = 5000000;
var const_gasMultiplierFactor = 2;


if (typeof web3 !== 'undefined') {
  web3 = new Web3(web3.currentProvider);
} else {
  web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8002"));
}

var useraccesscontractaddr = contract.ContractAddress();
var bytecode = contract.ByteCode();
var ABI = contract.ContractABI();

contractInstance = web3.eth.contract(ABI).at(useraccesscontractaddr);

var storage =   multer.diskStorage({
  destination: function (req, file, callback) {
    callback(null, path.join(__dirname,'./imagesPath/'));
  },
  filename: function (req, file, callback) {
    var ext = file.originalname.split('.').pop();
    callback(null,file.originalname);
  }
});

var upload = multer({ storage: storage})
var jsonparser = bodyparser.json();
app.set("json spaces",0);
app.use(express.static(__dirname+"/imagesPath"));
app.use(express.static(__dirname+"/downloads"));

app.get('/', function (req, res){
  //res.sendFile(path.join(__dirname+'/index.html'))
})

app.get('/register',function (req,res){
    var result = contractInstance.GetAvailableAddresses.call();

    console.log("result " + result);

    var patient,provider;
      if(result[2] ==0 && result[1][0] ==0)
      {
        res.sendStatus(404);
      }
      else
      {
        if(result[2] > 0)
        {
          patient = result[0][0];
        }
        if(result[3] > 0)
        {
          provider = result[1][0];
        }        
        res.json({patientAddress:patient, providerAddress:provider});
      }
});

app.get('/loginlogs',function (req,res){

    var loginEvents = contractInstance.UserAuthenticated({fromBlock: 0});

    loginEvents.watch(function(err,result){
      if(err){
        console.log(err);
        return;
      }

      console.log("Loginlogs" + result.args.authenticated + result.args.username + result.args.roleCd + result.args.userAddress);
    });
});

app.post('/register',jsonparser,function(req,res){

      var roleCd = req.body.role;
      var username = req.body.userName.toLowerCase();
      var password = req.body.password;
      var senderAddress = req.body.address;

      var transactionObject = {
            data: bytecode, 
            from: senderAddress,
            gasPrice: web3.eth.gasPrice,
            gas: const_gas
      };
        web3.eth.estimateGas(transactionObject, function(err, estimateGas){
        if(!err){          
          console.log("estimateGas is succes");
          transactionObject.gas = estimateGas * const_gasMultiplierFactor;

        }
        else
        {
          console.log("estimategas error" + err.toString());
        }

        console.log("transactionObject.gas" + transactionObject.gas);

          contractInstance.Register.sendTransaction(username, password,roleCd,senderAddress,transactionObject, function(err,result){

          if(err){
            console.log(err)
            res.status(500).send({error: err.toString()});            
          }
          else
          {
            var loggedEvent = contractInstance.UserAccountAdded();
            loggedEvent.watch(function(error, result) {
            if (error) 
            {
                console.log(error.toString())
                loggedEvent.stopWatching();
                res.status(500).send({error: error.toString()});
               
            }
            else
              {
                  if(result.args.registered) {
                    loggedEvent.stopWatching();
                    console.log("Registration is successfully");
                    res.end();
              }
              else{
                loggedEvent.stopWatching();
                res.status(400).send({error: "Registration Failed"});
              }
            }
            })
          }})
        });
});

app.post('/login',jsonparser,function(req,res,next){      

  try{
      
      console.log("Login is called" + Date.now());
      var username = req.body.userName.toLowerCase();
      var password = req.body.password;
      var senderAddress = web3.eth.accounts[0];
      var blocknumber = web3.eth.getBlock('latest').number;

      console.log("Login parameters,Username:" + username + ",password:" + password + ",senderAddress:" + senderAddress);

      var transactionObject = {
            data: bytecode, 
            from: senderAddress,
            gasPrice: web3.eth.gasPrice,
            gas: const_gas
      };
      web3.eth.estimateGas(transactionObject, function(err, estimateGas){
        console.log("estimateGas" + estimateGas + "const_gasMultiplierFactor" + const_gasMultiplierFactor);
      if(!err)
      {
          transactionObject.gas = estimateGas * const_gasMultiplierFactor;
      }
      else
      {
        console.log("transactionObject.gas"  + transactionObject.gas );

        console.log("Login gas error:" + err.toString());
         if(err.toString()=="Error: Out of gas")
         {
            console.log("Inside low gas. Attemping to increase ");
            transactionObject.gas = estimateGas * 100;
         }
         else if (err.toString()=="Error: Exceeds block gas limit")
         {
            transactionObject.gas = estimateGas / 10;
         }
         else
         {
            transactionObject.gas = 5000000000;    
         }
      }

      console.log("Login transaction to be called")
      
          contractInstance.Login.sendTransaction(username, password,transactionObject, function(err,result){
          if(err){
            console.log("Transaction failed:" + err)
            res.status(500).send({error: err.toString()});
          }
          else
          {
            var loggedEvent = contractInstance.UserAuthenticated({_from: senderAddress});
            loggedEvent.watch(function(error, result) {            
            console.log("login watch event received ");
            if (error) {
                console.log("errro" + error.toString())
                res.status(500).send({error: error.toString()});

            }
            else
            {
              console.log("login watch event received without error ");
              if(result.blockNumber > blocknumber){
                if(result.args.authenticated) {                                                                
                  console.log("Authenticated:" + result.args.authenticated + result.args.username + result.args.roleCd + result.args.userAddress);                                  
                  loggedEvent.stopWatching();
                  res.json({role:result.args.roleCd, address:result.args.userAddress})
                  res.end()
                  
                }
                else{
                  console.log("Authentication failes:" + result.args.authenticated + result.args.username + result.args.roleCd + result.args.userAddress);                                  
                    loggedEvent.stopWatching();                
                    res.status(401).send({error: "Authencation failed"});                  
                }
              }                
            }

            })
            }

        })
      })
  }
  catch (ex){
    console.log("Error during login process:" + ex);
    res.status(500).send({error: ex}); 
  }

});

app.post('/upload',upload.single('uploadfile'),function (req,res) {

  try{

    var fileHash, fileName;
    fileName = req.file.originalname;
    var senderAddress = req.body.address;

    ipfs.util.addFromFs(path.join(__dirname,'imagesPath',fileName),(err, result)=>{
    if (err) {
       // res.end(err.toString())       
       console.log("Upload file error to IPFS:" + err);
       res.status(500).send({error: err}); 
    }

    console.log("successfully uploaded the file to IPFS");

    fileHash = result[0].hash;
    fs.unlinkSync('./imagesPath/' + fileName);
    var transactionObject = {
              data: bytecode, 
              from: senderAddress,
              gasPrice: web3.eth.gasPrice,
              gas: const_gas
      };
    
    web3.eth.estimateGas(transactionObject, function(err, estimateGas){
    if(!err)
    {
        transactionObject.gas = estimateGas * const_gasMultiplierFactor;
    } 
    else
    {
      console.log("Error computing gas: manual gas")
      transactionObject.gas = 5000000;
    }
        contractInstance.UploadFile.sendTransaction(fileHash,fileName,transactionObject, function(err,result){

        if(err){
            console.log(err)
            res.status(500).send({error: err.toString()});
        }
        else
        {
            console.log("Watch is set for fileupload")
            var loggedEvent = contractInstance.FileUploaded();
            loggedEvent.watch(function(error, result) {
              if(result.args.uploaded) {
                loggedEvent.stopWatching();
                res.end();
              }
              else{
                loggedEvent.stopWatching();
                res.status(500).send({error: "Error Uploading File"});
              }
            });
        }

      })
    })

    });
  }
  catch (ex){
    console.log("Upload file error:" + ex);
    res.status(500).send({error: ex}); 
  }
  
});

app.get('/GetFile', function(req,res){

var fileId, fileHash,filename;

fileId = req.query.id;
fileHash = req.query.hash;
filename = req.query.filename

var transactionObject = {
              data: bytecode, 
              from: web3.eth.coinbase,
              gasPrice: web3.eth.gasPrice,
              gas: const_gas
      };

//currrently calling the etherium method only for logging purpose
contractInstance.DownloadFile.sendTransaction("file1",3,transactionObject,function(err,result){
        if(err){
            console.log(err)
            res.status(500).send({error: err.toString()});
        }
        else
        {
            console.log("downloadfile triggerred");
            var loggedEvent = contractInstance.FileDownloaded();
            loggedEvent.watch(function(error, result) {
              console.log("FileDownloaded watch triggerred");
              if (error) 
              {
                  console.log(error.toString())
                  loggedEvent.stopWatching();
              }
              else
              {
                console.log("FileDownload triggerred");
                loggedEvent.stopWatching();       
              }
            });
        }
      });
   

var filePath = path.join(__dirname, 'downloads',filename);
  if(fs.existsSync(filePath))
  {
    fs.unlinkSync(filePath);
  }
 ipfs.cat(fileHash,(err, stream)=>{

 // var downloadFile;
  

  if (err) {
     console.log(err.toString());
     res.status(500).send({error: err.toString()});     
  }
  var mimetype = mime.lookup(filePath);
  var writedoc = fs.createWriteStream(filePath,{'flags':'a'});
  
  res.setHeader('Content-disposition', 'attachment; filename=' + filename);
  res.setHeader('Content-type', mimetype);
  
  stream.on('data', function (chunk) {
  //  downloadFile += chunk;
    writedoc.write(chunk);
  })

  stream.on('error', function (err) {
    fs.unlinkSync(filePath);
    console.error('Error downloading file', err)
    res.status(500).send({error: err.toString()});    
  })

  stream.on('end', function () {
  var outfile = fs.createReadStream(filePath);
  outfile.pipe(res);
  })

})
});


app.get('/share/GetProviders',function(req,res)
{

  var result = contractInstance.GetProviders.call();
  var providerArr = new Array();
  var provider;
  if(result[2] >0)
  {
    for(var i =0;i<result[2];i++)
    {
      provider = {providerName: web3.toAscii(result[0][i]).replace(/\u0000/g, ''), providerAddress:result[1][i]}; 
      providerArr.push(provider);
    }
    res.json({providers: providerArr});
  }
  else
  {
    res.status(400).send({error: "No providers registered"});
  }
});

//used for development/testing only
app.get('/ResetContract',function(req,res)
{


  var transactionObject = {
            data: bytecode,
            from: web3.eth.coinbase,
            gasPrice: web3.eth.gasPrice,
            gas: const_gas
      };

  web3.eth.estimateGas(transactionObject, function(err, estimateGas){
    if(!err)
      transactionObject.gas = estimateGas * const_gasMultiplierFactor;
      contractInstance.ResetContract.sendTransaction(transactionObject, function(err,result){

        if(err){
          console.log("reset failed:" + err);
          res.status(500).send({error: err.toString()}); 
        }
        else{
          
          //Add address v
          for(var i=1; i<=25;i++)
          {
              contractInstance.AddAddress.sendTransaction(
                web3.eth.accounts[i],
                2,
                {
                   from: web3.eth.coinbase, 
                   data: '0x60606040523462000000576040516200489f3803806200489f833981016040528080518201919060200180518201919060200150505b6080604051908101604052803381526020018381526020018281526020016001815260200150600560003373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c010000000000000000000000009081020402179055506020820151816001019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200011b57805160ff19168380011785556200014c565b828001600101855582156200014c579182015b828111156200014b5782518255916020019190600101906200012e565b5b5090506200017491905b808211156200017057600081600090555060010162000156565b5090565b50506040820151816002019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10620001ca57805160ff1916838001178555620001fb565b82800160010185558215620001fb579182015b82811115620001fa578251825591602001919060010190620001dd565b5b5090506200022391905b808211156200021f57600081600090555060010162000205565b5090565b505060608201518160030160006101000a81548160ff02191690837f0100000000000000000000000000000000000000000000000000000000000000908102040217905550905050600560003373ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006600060005481526020019081526020016000206000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060018201816001019080546001816001161561010002031660029004828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10620003635780548555620003a3565b82800160010185558215620003a357600052602060002091601f016020900482015b82811115620003a257825482559160010191906001019062000385565b5b509050620003cb91905b80821115620003c7576000816000905550600101620003ad565b5090565b505060028201816002019080546001816001161561010002031660029004828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1062000424578054855562000464565b828001600101855582156200046457600052602060002091601f016020900482015b828111156200046357825482559160010191906001019062000446565b5b5090506200048c91905b80821115620004885760008160009055506001016200046e565b5090565b50506003820160009054906101000a900460ff168160030160006101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050506000600081548092919060010191905055505b50505b61439980620005066000396000f360606040523615610141576000357c010000000000000000000000000000000000000000000000000000000090048063068ce4a21461015357806310055c1d1461018f57806310352bc3146101ba5780631c14541b146102d6578063206565d2146104345780632368e32314610470578063306f2ff91461050a578063359a6eec146105b657806339557b011461063e5780634e5bbcba1461073d5780634e64f6bb146107a4578063598949711461080357806360c97b961461083f5780636ef76a50146109a75780636fa953da14610a9f57806385f9c74414610b4257806387b15eb614610b75578063a833b0d014610ba6578063a87430ba14610cff578063cfb5192814610e67578063e232006514610ed6578063e4e10b3614610f44578063e6b5a95e14610f75578063f237f88f14610fe9578063f74f247c1461112d575b34610000576101515b610000565b565b005b3461000057610177600480803590602001909190803590602001909190505061115e565b60405180821515815260200191505060405180910390f35b346100005761019c611570565b60405180826003811161000057815260200191505060405180910390f35b34610000576101de6004808035906020019091908035906020019091905050611583565b60405180868152602001858152602001806020018473ffffffffffffffffffffffffffffffffffffffff168152602001806020018381038352868181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561026a5780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156102c35780820380516001836020036101000a031916815260200191505b5097505050505050505060405180910390f35b34610000576102fa60048080359060200190919080359060200190919050506118ab565b604051808681526020018060200180602001806020018581526020018481038452888181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561036e5780820380516001836020036101000a031916815260200191505b508481038352878181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156103c75780820380516001836020036101000a031916815260200191505b508481038252868181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156104205780820380516001836020036101000a031916815260200191505b509850505050505050505060405180910390f35b34610000576104586004808035906020019091908035906020019091905050611cc8565b60405180821515815260200191505060405180910390f35b3461000057610508600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050611eef565b005b34610000576105b4600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001909190803590602001909190505061216e565b005b3461000057610626600480803590602001909190803590602001909190803590602001909190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919050506128f2565b60405180821515815260200191505060405180910390f35b34610000576106626004808035906020019091908035906020019091905050612ba4565b6040518085815260200184815260200180602001806020018381038352858181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156106d25780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561072b5780820380516001836020036101000a031916815260200191505b50965050505050505060405180910390f35b346100005761074a612e8e565b60405180846032602002808383829060006004602084601f0104600302600f01f150905001836032602002808383829060006004602084601f0104600302600f01f150905001828152602001935050505060405180910390f35b34610000576107bf600480803590602001909190505061306f565b604051808473ffffffffffffffffffffffffffffffffffffffff16815260200183600381116100005781526020018215158152602001935050505060405180910390f35b346100005761082760048080359060200190919080359060200190919050506130d3565b60405180821515815260200191505060405180910390f35b346100005761085a60048080359060200190919050506131e6565b604051808573ffffffffffffffffffffffffffffffffffffffff168152602001806020018060200184600381116100005781526020018381038352868181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156109115780601f106108e657610100808354040283529160200191610911565b820191906000526020600020905b8154815290600101906020018083116108f457829003601f168201915b50508381038252858181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156109945780601f1061096957610100808354040283529160200191610994565b820191906000526020600020905b81548152906001019060200180831161097757829003601f168201915b5050965050505050505060405180910390f35b34610000576109cb6004808035906020019091908035906020019091905050613241565b6040518084815260200180602001806020018381038352858181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f168015610a355780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f168015610a8e5780820380516001836020036101000a031916815260200191505b509550505050505060405180910390f35b3461000057610b40600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001909190505061347c565b005b3461000057610b5d600480803590602001909190505061372d565b60405180821515815260200191505060405180910390f35b3461000057610b9060048080359060200190919050506137c7565b6040518082815260200191505060405180910390f35b3461000057610bc16004808035906020019091905050613897565b6040518080602001806020018473ffffffffffffffffffffffffffffffffffffffff168152602001838103835286818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610c6a5780601f10610c3f57610100808354040283529160200191610c6a565b820191906000526020600020905b815481529060010190602001808311610c4d57829003601f168201915b5050838103825285818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610ced5780601f10610cc257610100808354040283529160200191610ced565b820191906000526020600020905b815481529060010190602001808311610cd057829003601f168201915b50509550505050505060405180910390f35b3461000057610d1a60048080359060200190919050506138df565b604051808573ffffffffffffffffffffffffffffffffffffffff16815260200180602001806020018460038111610000578152602001838103835286818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610dd15780601f10610da657610100808354040283529160200191610dd1565b820191906000526020600020905b815481529060010190602001808311610db457829003601f168201915b5050838103825285818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610e545780601f10610e2957610100808354040283529160200191610e54565b820191906000526020600020905b815481529060010190602001808311610e3757829003601f168201915b5050965050505050505060405180910390f35b3461000057610ebc600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190505061393a565b604051808260001916815260200191505060405180910390f35b3461000057610ee3613949565b60405180856032602002808383829060006004602084601f0104600302600f01f150905001846032602002808383829060006004602084601f0104600302600f01f15090500183815260200182815260200194505050505060405180910390f35b3461000057610f5f6004808035906020019091905050613b4e565b6040518082815260200191505060405180910390f35b3461000057610f906004808035906020019091905050613bf2565b604051808581526020018473ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff168152602001821515815260200194505050505060405180910390f35b3461000057611059600480803590602001909190803590602001909190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091908035906020019091905050613c6f565b6040518080602001848152602001806020018381038352868181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156110c35780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561111c5780820380516001836020036101000a031916815260200191505b509550505050505060405180910390f35b346100005761114860048080359060200190919050506140b5565b6040518082815260200191505060405180910390f35b60006000600060006000600460008881526020019081526020016000209350600092508573ffffffffffffffffffffffffffffffffffffffff168460020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561152457600090505b6002548110156113ca576007600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508173ffffffffffffffffffffffffffffffffffffffff168673ffffffffffffffffffffffffffffffffffffffff161480156112715750866007600083815260200190815260200160002060000154145b156113bc576007600082815260200190815260200160002060020160149054906101000a900460ff16156112e4577fe1fab20581d179581fe822eeb7db36e3a12e539dbf04fb0b6fbd755639e017348360405180821515815260200191505060405180910390a1829450611566566113bb565b60076000828152602001908152602001600020600060008201600090556001820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556002820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556002820160146101000a81549060ff021916905550506001925060026000815460019003919050819055507fe1fab20581d179581fe822eeb7db36e3a12e539dbf04fb0b6fbd755639e017348360405180821515815260200191505060405180910390a1829450611566565b5b5b80806001019150506111de565b60046000888152602001908152602001600020600060008201805460018160011615610100020316600290046000825580601f10611408575061143f565b601f01602090049060005260206000209081019061143e91905b8082111561143a576000816000905550600101611422565b5090565b5b5060018201805460018160011615610100020316600290046000825580601f1061146957506114a0565b601f01602090049060005260206000209081019061149f91905b8082111561149b576000816000905550600101611483565b5090565b5b506002820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff021916905550506001600081546001900391905081905550600192507fe1fab20581d179581fe822eeb7db36e3a12e539dbf04fb0b6fbd755639e017348360405180821515815260200191505060405180910390a182945061156656611565565b7fe1fab20581d179581fe822eeb7db36e3a12e539dbf04fb0b6fbd755639e017348360405180821515815260200191505060405180910390a1829450611566565b5b5050505092915050565b600960009054906101000a900460ff1681565b60006000602060405190810160405280600081526020015060006020604051908101604052806000815260200150600060008890505b60025481101561189a576007600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508773ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614801561165757506007600082815260200190815260200160002060020160149054906101000a900460ff165b1561188c576007600082815260200190815260200160002060000154965060046000600760008481526020019081526020016000206000015481526020019081526020016000206001018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156117355780601f1061170a57610100808354040283529160200191611735565b820191906000526020600020905b81548152906001019060200180831161171857829003601f168201915b505050505094506007600082815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169350600560006007600084815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561186b5780601f106118405761010080835404028352916020019161186b565b820191906000526020600020905b81548152906001019060200180831161184e57829003601f168201915b5050505050925060018101955086868686869650965096509650965061189f565b5b80806001019150506115b9565b610000565b50509295509295909350565b600060206040519081016040528060008152602001506020604051908101604052806000815260200150602060405190810160405280600081526020015060006000600060008891505b600254821015611cb6576007600083815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1692508973ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614801561199357506007600083815260200190815260200160002060020160149054906101000a900460ff165b15611ca857600460006007600085815260200190815260200160002060000154815260200190815260200160002090506007600083815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168160020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415611ca757819350600760008381526020019081526020016000206000015481600101600560008460020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018360000187838054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611b595780601f10611b2e57610100808354040283529160200191611b59565b820191906000526020600020905b815481529060010190602001808311611b3c57829003601f168201915b50505050509350828054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611bf55780601f10611bca57610100808354040283529160200191611bf5565b820191906000526020600020905b815481529060010190602001808311611bd857829003601f168201915b50505050509250818054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611c915780601f10611c6657610100808354040283529160200191611c91565b820191906000526020600020905b815481529060010190602001808311611c7457829003601f168201915b5050505050915097509750975097509750611cbb565b5b5b81806001019250506118f5565b610000565b5050509295509295909350565b60006000600090505b600354811015611d96578373ffffffffffffffffffffffffffffffffffffffff166008600083815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415611d88577f63a5eccd848f95f4a09b1d48db73ca4c5202ce7dcf8c10113549d7612f59ec86600060405180821515815260200191505060405180910390a160009150611ee8565b5b8080600101915050611cd1565b606060405190810160405280858152602001848152602001600081526020015060086000600354815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060208201518160000160146101000a81548160ff02191690837f010000000000000000000000000000000000000000000000000000000000000090810204021790555060408201518160000160156101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050506003600081548092919060010191905055507f63a5eccd848f95f4a09b1d48db73ca4c5202ce7dcf8c10113549d7612f59ec86600160405180821515815260200191505060405180910390a1600191505b5092915050565b6000606060405190810160405280848152602001838152602001338152602001506004600060015481526020019081526020016000206000820151816000019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10611f7757805160ff1916838001178555611fa5565b82800160010185558215611fa5579182015b82811115611fa4578251825591602001919060010190611f89565b5b509050611fca91905b80821115611fc6576000816000905550600101611fae565b5090565b50506020820151816001019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061201e57805160ff191683800117855561204c565b8280016001018555821561204c579182015b8281111561204b578251825591602001919060010190612030565b5b50905061207191905b8082111561206d576000816000905550600101612055565b5090565b505060408201518160020160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c01000000000000000000000000908102040217905550905050600160008154809291906001019190505550600190507f4d4b9742a60461b9030134e4544ec7e538062d9be5beeefdf073d68840ee67868282604051808060200183151581526020018281038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561215a5780820380516001836020036101000a031916815260200191505b50935050505060405180910390a15b505050565b600061217a8286614185565b15156128ab5760806040519081016040528083815260200186815260200185815260200184815260200150600560008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c010000000000000000000000009081020402179055506020820151816001019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061226357805160ff1916838001178555612291565b82800160010185558215612291579182015b82811115612290578251825591602001919060010190612275565b5b5090506122b691905b808211156122b257600081600090555060010161229a565b5090565b50506040820151816002019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061230a57805160ff1916838001178555612338565b82800160010185558215612338579182015b8281111561233757825182559160200191906001019061231c565b5b50905061235d91905b80821115612359576000816000905550600101612341565b5090565b505060608201518160030160006101000a81548160ff02191690837f0100000000000000000000000000000000000000000000000000000000000000908102040217905550905050600560008373ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006600060005481526020019081526020016000206000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060018201816001019080546001816001161561010002031660029004828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061249b57805485556124d8565b828001600101855582156124d857600052602060002091601f016020900482015b828111156124d75782548255916001019190600101906124bc565b5b5090506124fd91905b808211156124f95760008160009055506001016124e1565b5090565b505060028201816002019080546001816001161561010002031660029004828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106125545780548555612591565b8280016001018555821561259157600052602060002091601f016020900482015b82811115612590578254825591600101919060010190612575565b5b5090506125b691905b808211156125b257600081600090555060010161259a565b5090565b50506003820160009054906101000a900460ff168160030160006101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050506000600081548092919060010191905055508173ffffffffffffffffffffffffffffffffffffffff16600560008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561286757600090505b600354811015612862578173ffffffffffffffffffffffffffffffffffffffff166008600083815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156128545760606040519081016040528083815260200184815260200160018152602001506008600083815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060208201518160000160146101000a81548160ff02191690837f010000000000000000000000000000000000000000000000000000000000000090810204021790555060408201518160000160156101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050507f01eaf77f56b9b7869ab792dfca343a997e1a60b27b2a44a5e23e66fbd92d0d28600160405180821515815260200191505060405180910390a16128eb565b5b80806001019150506126a2565b6128a6565b7f01eaf77f56b9b7869ab792dfca343a997e1a60b27b2a44a5e23e66fbd92d0d28600060405180821515815260200191505060405180910390a16128eb565b6128ea565b7f01eaf77f56b9b7869ab792dfca343a997e1a60b27b2a44a5e23e66fbd92d0d28600060405180821515815260200191505060405180910390a16128eb565b5b5050505050565b6000600061290084876130d3565b801561291157506129108561372d565b5b15612b9557600560008673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020905060806040519081016040528085815260200187815260200186815260200160018152602001506007600060025481526020019081526020016000206000820151816000015560208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060408201518160020160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060608201518160020160146101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050506002600081548092919060010191905055507ffc802800e979e3cde4e3e50560d6359056315e1afcffcd5d3055c4e59a9099168382600101866040518080602001806020018481526020018381038352868181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f168015612af55780820380516001836020036101000a031916815260200191505b50838103825285818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015612b775780601f10612b4c57610100808354040283529160200191612b77565b820191906000526020600020905b815481529060010190602001808311612b5a57829003601f168201915b50509550505050505060405180910390a160019150612b9b56612b9a565b610000565b5b50949350505050565b6000600060206040519081016040528060008152602001506020604051908101604052806000815260200150600060008790505b600254811015612e7e576007600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508673ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16148015612c7757506007600082815260200190815260200160002060020160149054906101000a900460ff16155b15612e70576007600082815260200190815260200160002060000154955060046000600760008481526020019081526020016000206000015481526020019081526020016000206001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612d555780601f10612d2a57610100808354040283529160200191612d55565b820191906000526020600020905b815481529060010190602001808311612d3857829003601f168201915b50505050509350600560006007600084815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612e525780601f10612e2757610100808354040283529160200191612e52565b820191906000526020600020905b815481529060010190602001808311612e3557829003601f168201915b50505050509250600181019450858585859550955095509550612e83565b5b8080600101915050612bd8565b610000565b505092959194509250565b610640604051908101604052806032905b6000815260200190600190039081612e9f57905050610640604051908101604052806032905b6000815260200190600190039081612ec5579050506000600060006000600091505b60005482101561305d57600660008381526020019081526020016000209050600360038111610000578160030160009054906101000a900460ff166003811161000057141561304f57612fd5816001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612fcb5780601f10612fa057610100808354040283529160200191612fcb565b820191906000526020600020905b815481529060010190602001808311612fae57829003601f168201915b505050505061393a565b86846032811015610000576020020190600019169081815260200150508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168584603281101561000057602002019073ffffffffffffffffffffffffffffffffffffffff1690818152602001505082806001019350505b5b8180600101925050612ee7565b8585849550955095505b505050909192565b60086020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060000160149054906101000a900460ff16908060000160159054906101000a900460ff16905083565b60006000600560008473ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020905060008160010180546001816001161561010002031660029004905011801561314b5750600260038111610000578160030160009054906101000a900460ff166003811161000057145b156131d5578273ffffffffffffffffffffffffffffffffffffffff166004600086815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156131c757600191506131df566131d0565b600091506131df565b6131de565b600091506131df565b5b5092915050565b60066020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690806001019080600201908060030160009054906101000a900460ff16905084565b600060206040519081016040528060008152602001506020604051908101604052806000815260200150600060008690505b60015481101561346e576004600082815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508573ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16141561346057600460008281526020019081526020016000206000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156133945780601f1061336957610100808354040283529160200191613394565b820191906000526020600020905b81548152906001019060200180831161337757829003601f168201915b50505050509350600460008281526020019081526020016000206001018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156134455780601f1061341a57610100808354040283529160200191613445565b820191906000526020600020905b81548152906001019060200180831161342857829003601f168201915b50505050509250600181019450848484945094509450613473565b5b8080600101915050613273565b610000565b50509250925092565b600060006000600560008573ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002092508260010191508260020190506134c38287614208565b80156134d557506134d48186614208565b5b15613656578260030160009054906101000a900460ff16600960006101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055507f8e87a604d7135508ef70e0c10ff0fb74e4423b183de8a16b268aec8928191415600183600960009054906101000a900460ff1660038111610000578660000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16604051808515158152602001806020018481526020018373ffffffffffffffffffffffffffffffffffffffff16815260200182810382528581815460018160011615610100020316600290048152602001915080546001816001161561010002031660029004801561363c5780601f106136115761010080835404028352916020019161363c565b820191906000526020600020905b81548152906001019060200180831161361f57829003601f168201915b50509550505050505060405180910390a161372556613724565b7f8e87a604d7135508ef70e0c10ff0fb74e4423b183de8a16b268aec89281914156000876000600381116100005787604051808515158152602001806020018481526020018373ffffffffffffffffffffffffffffffffffffffff1681526020018281038252858181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561370f5780820380516001836020036101000a031916815260200191505b509550505050505060405180910390a1613725565b5b505050505050565b60006000600560008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002090506000816001018054600181600116156101000203166002900490501180156137a55750600360038111610000578160030160009054906101000a900460ff166003811161000057145b156137b757600191506137c1566137c0565b600091506137c1565b5b50919050565b600060006000600090505b60025481101561388c576007600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508373ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614801561387057506007600082815260200190815260200160002060020160149054906101000a900460ff165b1561387e5782806001019350505b5b80806001019150506137d2565b8292505b5050919050565b6004602052806000526040600020600091509050806000019080600101908060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905083565b60056020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690806001019080600201908060030160009054906101000a900460ff16905084565b6000602082015190505b919050565b610640604051908101604052806032905b600081526020019060019003908161395a57905050610640604051908101604052806032905b6000815260200190600190039081613980579050506000600060006000925060009150600090505b600354811015613b46576008600082815260200190815260200160002060000160159054906101000a900460ff161515613b3857600260038111610000576008600083815260200190815260200160002060000160149054906101000a900460ff1660038111610000571415613a8b576008600082815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168584603281101561000057602002019073ffffffffffffffffffffffffffffffffffffffff169081815260200150508280600101935050613b37565b600360038111610000576008600083815260200190815260200160002060000160149054906101000a900460ff1660038111610000571415613b36576008600082815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168483603281101561000057602002019073ffffffffffffffffffffffffffffffffffffffff1690818152602001505081806001019250505b5b5b5b80806001019150506139a8565b5b5090919293565b600060006000600090505b600154811015613be7576004600082815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508373ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff161415613bd95782806001019350505b5b8080600101915050613b59565b8292505b5050919050565b60076020528060005260406000206000915090508060000154908060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060020160149054906101000a900460ff16905084565b60206040519081016040528060008152602001506000602060405190810160405280600081526020015060006000613ca7888a6130d3565b8015613cb85750613cb78661372d565b5b156140a357600091505b60025482101561409e576007600083815260200190815260200160002090508873ffffffffffffffffffffffffffffffffffffffff168160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16148015613d435750878160000154145b8015613d9e57508573ffffffffffffffffffffffffffffffffffffffff168160020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16145b8015613db857508060020160149054906101000a900460ff165b15614090576080604051908101604052808981526020018a81526020018781526020016000815260200150600760008481526020019081526020016000206000820151816000015560208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060408201518160020160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060608201518160020160146101000a81548160ff02191690837f0100000000000000000000000000000000000000000000000000000000000000908102040217905550905050600560008773ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015613f8c5780601f10613f6157610100808354040283529160200191613f8c565b820191906000526020600020905b815481529060010190602001808311613f6f57829003601f168201915b505050505092507f2006a4633f6dc655838ce11378f6a5b94ad542f29c67b7f2c7f71833db2a5c1187846040518080602001806020018381038352858181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561401a5780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156140735780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a18688849450945094506140a9565b5b8180600101925050613cc2565b6140a8565b610000565b5b50509450945094915050565b600060006000600090505b60025481101561417a576007600082815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508373ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614801561415e57506007600082815260200190815260200160002060020160149054906101000a900460ff165b1561416c5782806001019350505b5b80806001019150506140c0565b8292505b5050919050565b60006000600560008573ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002090506000816001018054600181600116156101000203166002900490501180156141e557506141e48160010184614208565b5b156141f7576001915061420156614200565b60009150614201565b5b5092915050565b60006000602060405190810160405280600081526020015060008592508491508151838054600181600116156101000203166002900490501415156142505760009350614390565b600090505b8280546001816001161561010002031660029004905081101561438b5781818151811015610000579060200101517f010000000000000000000000000000000000000000000000000000000000000090047f0100000000000000000000000000000000000000000000000000000000000000027effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916838281546001816001161561010002031660029004811015610000578154600116156143255790600052602060002090602091828204019190065b9054901a7f0100000000000000000000000000000000000000000000000000000000000000027effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614151561437d5760009350614390565b5b8080600101915050614255565b600193505b5050509291505056', 
                   gas: '9700000'
                },function (e, contract){
                  console.log(e, contract);    
                       console.log('PatientAddress added: ');    
               })
          }
          
          for (var i = 26; i <= 48; i++) {
            contractInstance.AddAddress.sendTransaction(
              web3.eth.accounts[i],
              3,
              {
                 from: web3.eth.coinbase, 
                 data: '0x60606040523462000000576040516200489f3803806200489f833981016040528080518201919060200180518201919060200150505b6080604051908101604052803381526020018381526020018281526020016001815260200150600560003373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c010000000000000000000000009081020402179055506020820151816001019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200011b57805160ff19168380011785556200014c565b828001600101855582156200014c579182015b828111156200014b5782518255916020019190600101906200012e565b5b5090506200017491905b808211156200017057600081600090555060010162000156565b5090565b50506040820151816002019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10620001ca57805160ff1916838001178555620001fb565b82800160010185558215620001fb579182015b82811115620001fa578251825591602001919060010190620001dd565b5b5090506200022391905b808211156200021f57600081600090555060010162000205565b5090565b505060608201518160030160006101000a81548160ff02191690837f0100000000000000000000000000000000000000000000000000000000000000908102040217905550905050600560003373ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006600060005481526020019081526020016000206000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060018201816001019080546001816001161561010002031660029004828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10620003635780548555620003a3565b82800160010185558215620003a357600052602060002091601f016020900482015b82811115620003a257825482559160010191906001019062000385565b5b509050620003cb91905b80821115620003c7576000816000905550600101620003ad565b5090565b505060028201816002019080546001816001161561010002031660029004828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1062000424578054855562000464565b828001600101855582156200046457600052602060002091601f016020900482015b828111156200046357825482559160010191906001019062000446565b5b5090506200048c91905b80821115620004885760008160009055506001016200046e565b5090565b50506003820160009054906101000a900460ff168160030160006101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050506000600081548092919060010191905055505b50505b61439980620005066000396000f360606040523615610141576000357c010000000000000000000000000000000000000000000000000000000090048063068ce4a21461015357806310055c1d1461018f57806310352bc3146101ba5780631c14541b146102d6578063206565d2146104345780632368e32314610470578063306f2ff91461050a578063359a6eec146105b657806339557b011461063e5780634e5bbcba1461073d5780634e64f6bb146107a4578063598949711461080357806360c97b961461083f5780636ef76a50146109a75780636fa953da14610a9f57806385f9c74414610b4257806387b15eb614610b75578063a833b0d014610ba6578063a87430ba14610cff578063cfb5192814610e67578063e232006514610ed6578063e4e10b3614610f44578063e6b5a95e14610f75578063f237f88f14610fe9578063f74f247c1461112d575b34610000576101515b610000565b565b005b3461000057610177600480803590602001909190803590602001909190505061115e565b60405180821515815260200191505060405180910390f35b346100005761019c611570565b60405180826003811161000057815260200191505060405180910390f35b34610000576101de6004808035906020019091908035906020019091905050611583565b60405180868152602001858152602001806020018473ffffffffffffffffffffffffffffffffffffffff168152602001806020018381038352868181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561026a5780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156102c35780820380516001836020036101000a031916815260200191505b5097505050505050505060405180910390f35b34610000576102fa60048080359060200190919080359060200190919050506118ab565b604051808681526020018060200180602001806020018581526020018481038452888181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561036e5780820380516001836020036101000a031916815260200191505b508481038352878181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156103c75780820380516001836020036101000a031916815260200191505b508481038252868181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156104205780820380516001836020036101000a031916815260200191505b509850505050505050505060405180910390f35b34610000576104586004808035906020019091908035906020019091905050611cc8565b60405180821515815260200191505060405180910390f35b3461000057610508600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050611eef565b005b34610000576105b4600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001909190803590602001909190505061216e565b005b3461000057610626600480803590602001909190803590602001909190803590602001909190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919050506128f2565b60405180821515815260200191505060405180910390f35b34610000576106626004808035906020019091908035906020019091905050612ba4565b6040518085815260200184815260200180602001806020018381038352858181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156106d25780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561072b5780820380516001836020036101000a031916815260200191505b50965050505050505060405180910390f35b346100005761074a612e8e565b60405180846032602002808383829060006004602084601f0104600302600f01f150905001836032602002808383829060006004602084601f0104600302600f01f150905001828152602001935050505060405180910390f35b34610000576107bf600480803590602001909190505061306f565b604051808473ffffffffffffffffffffffffffffffffffffffff16815260200183600381116100005781526020018215158152602001935050505060405180910390f35b346100005761082760048080359060200190919080359060200190919050506130d3565b60405180821515815260200191505060405180910390f35b346100005761085a60048080359060200190919050506131e6565b604051808573ffffffffffffffffffffffffffffffffffffffff168152602001806020018060200184600381116100005781526020018381038352868181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156109115780601f106108e657610100808354040283529160200191610911565b820191906000526020600020905b8154815290600101906020018083116108f457829003601f168201915b50508381038252858181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156109945780601f1061096957610100808354040283529160200191610994565b820191906000526020600020905b81548152906001019060200180831161097757829003601f168201915b5050965050505050505060405180910390f35b34610000576109cb6004808035906020019091908035906020019091905050613241565b6040518084815260200180602001806020018381038352858181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f168015610a355780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f168015610a8e5780820380516001836020036101000a031916815260200191505b509550505050505060405180910390f35b3461000057610b40600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001909190505061347c565b005b3461000057610b5d600480803590602001909190505061372d565b60405180821515815260200191505060405180910390f35b3461000057610b9060048080359060200190919050506137c7565b6040518082815260200191505060405180910390f35b3461000057610bc16004808035906020019091905050613897565b6040518080602001806020018473ffffffffffffffffffffffffffffffffffffffff168152602001838103835286818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610c6a5780601f10610c3f57610100808354040283529160200191610c6a565b820191906000526020600020905b815481529060010190602001808311610c4d57829003601f168201915b5050838103825285818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610ced5780601f10610cc257610100808354040283529160200191610ced565b820191906000526020600020905b815481529060010190602001808311610cd057829003601f168201915b50509550505050505060405180910390f35b3461000057610d1a60048080359060200190919050506138df565b604051808573ffffffffffffffffffffffffffffffffffffffff16815260200180602001806020018460038111610000578152602001838103835286818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610dd15780601f10610da657610100808354040283529160200191610dd1565b820191906000526020600020905b815481529060010190602001808311610db457829003601f168201915b5050838103825285818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610e545780601f10610e2957610100808354040283529160200191610e54565b820191906000526020600020905b815481529060010190602001808311610e3757829003601f168201915b5050965050505050505060405180910390f35b3461000057610ebc600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190505061393a565b604051808260001916815260200191505060405180910390f35b3461000057610ee3613949565b60405180856032602002808383829060006004602084601f0104600302600f01f150905001846032602002808383829060006004602084601f0104600302600f01f15090500183815260200182815260200194505050505060405180910390f35b3461000057610f5f6004808035906020019091905050613b4e565b6040518082815260200191505060405180910390f35b3461000057610f906004808035906020019091905050613bf2565b604051808581526020018473ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff168152602001821515815260200194505050505060405180910390f35b3461000057611059600480803590602001909190803590602001909190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091908035906020019091905050613c6f565b6040518080602001848152602001806020018381038352868181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156110c35780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561111c5780820380516001836020036101000a031916815260200191505b509550505050505060405180910390f35b346100005761114860048080359060200190919050506140b5565b6040518082815260200191505060405180910390f35b60006000600060006000600460008881526020019081526020016000209350600092508573ffffffffffffffffffffffffffffffffffffffff168460020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561152457600090505b6002548110156113ca576007600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508173ffffffffffffffffffffffffffffffffffffffff168673ffffffffffffffffffffffffffffffffffffffff161480156112715750866007600083815260200190815260200160002060000154145b156113bc576007600082815260200190815260200160002060020160149054906101000a900460ff16156112e4577fe1fab20581d179581fe822eeb7db36e3a12e539dbf04fb0b6fbd755639e017348360405180821515815260200191505060405180910390a1829450611566566113bb565b60076000828152602001908152602001600020600060008201600090556001820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556002820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556002820160146101000a81549060ff021916905550506001925060026000815460019003919050819055507fe1fab20581d179581fe822eeb7db36e3a12e539dbf04fb0b6fbd755639e017348360405180821515815260200191505060405180910390a1829450611566565b5b5b80806001019150506111de565b60046000888152602001908152602001600020600060008201805460018160011615610100020316600290046000825580601f10611408575061143f565b601f01602090049060005260206000209081019061143e91905b8082111561143a576000816000905550600101611422565b5090565b5b5060018201805460018160011615610100020316600290046000825580601f1061146957506114a0565b601f01602090049060005260206000209081019061149f91905b8082111561149b576000816000905550600101611483565b5090565b5b506002820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff021916905550506001600081546001900391905081905550600192507fe1fab20581d179581fe822eeb7db36e3a12e539dbf04fb0b6fbd755639e017348360405180821515815260200191505060405180910390a182945061156656611565565b7fe1fab20581d179581fe822eeb7db36e3a12e539dbf04fb0b6fbd755639e017348360405180821515815260200191505060405180910390a1829450611566565b5b5050505092915050565b600960009054906101000a900460ff1681565b60006000602060405190810160405280600081526020015060006020604051908101604052806000815260200150600060008890505b60025481101561189a576007600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508773ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614801561165757506007600082815260200190815260200160002060020160149054906101000a900460ff165b1561188c576007600082815260200190815260200160002060000154965060046000600760008481526020019081526020016000206000015481526020019081526020016000206001018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156117355780601f1061170a57610100808354040283529160200191611735565b820191906000526020600020905b81548152906001019060200180831161171857829003601f168201915b505050505094506007600082815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169350600560006007600084815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561186b5780601f106118405761010080835404028352916020019161186b565b820191906000526020600020905b81548152906001019060200180831161184e57829003601f168201915b5050505050925060018101955086868686869650965096509650965061189f565b5b80806001019150506115b9565b610000565b50509295509295909350565b600060206040519081016040528060008152602001506020604051908101604052806000815260200150602060405190810160405280600081526020015060006000600060008891505b600254821015611cb6576007600083815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1692508973ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614801561199357506007600083815260200190815260200160002060020160149054906101000a900460ff165b15611ca857600460006007600085815260200190815260200160002060000154815260200190815260200160002090506007600083815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168160020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415611ca757819350600760008381526020019081526020016000206000015481600101600560008460020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018360000187838054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611b595780601f10611b2e57610100808354040283529160200191611b59565b820191906000526020600020905b815481529060010190602001808311611b3c57829003601f168201915b50505050509350828054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611bf55780601f10611bca57610100808354040283529160200191611bf5565b820191906000526020600020905b815481529060010190602001808311611bd857829003601f168201915b50505050509250818054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611c915780601f10611c6657610100808354040283529160200191611c91565b820191906000526020600020905b815481529060010190602001808311611c7457829003601f168201915b5050505050915097509750975097509750611cbb565b5b5b81806001019250506118f5565b610000565b5050509295509295909350565b60006000600090505b600354811015611d96578373ffffffffffffffffffffffffffffffffffffffff166008600083815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415611d88577f63a5eccd848f95f4a09b1d48db73ca4c5202ce7dcf8c10113549d7612f59ec86600060405180821515815260200191505060405180910390a160009150611ee8565b5b8080600101915050611cd1565b606060405190810160405280858152602001848152602001600081526020015060086000600354815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060208201518160000160146101000a81548160ff02191690837f010000000000000000000000000000000000000000000000000000000000000090810204021790555060408201518160000160156101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050506003600081548092919060010191905055507f63a5eccd848f95f4a09b1d48db73ca4c5202ce7dcf8c10113549d7612f59ec86600160405180821515815260200191505060405180910390a1600191505b5092915050565b6000606060405190810160405280848152602001838152602001338152602001506004600060015481526020019081526020016000206000820151816000019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10611f7757805160ff1916838001178555611fa5565b82800160010185558215611fa5579182015b82811115611fa4578251825591602001919060010190611f89565b5b509050611fca91905b80821115611fc6576000816000905550600101611fae565b5090565b50506020820151816001019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061201e57805160ff191683800117855561204c565b8280016001018555821561204c579182015b8281111561204b578251825591602001919060010190612030565b5b50905061207191905b8082111561206d576000816000905550600101612055565b5090565b505060408201518160020160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c01000000000000000000000000908102040217905550905050600160008154809291906001019190505550600190507f4d4b9742a60461b9030134e4544ec7e538062d9be5beeefdf073d68840ee67868282604051808060200183151581526020018281038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561215a5780820380516001836020036101000a031916815260200191505b50935050505060405180910390a15b505050565b600061217a8286614185565b15156128ab5760806040519081016040528083815260200186815260200185815260200184815260200150600560008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c010000000000000000000000009081020402179055506020820151816001019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061226357805160ff1916838001178555612291565b82800160010185558215612291579182015b82811115612290578251825591602001919060010190612275565b5b5090506122b691905b808211156122b257600081600090555060010161229a565b5090565b50506040820151816002019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061230a57805160ff1916838001178555612338565b82800160010185558215612338579182015b8281111561233757825182559160200191906001019061231c565b5b50905061235d91905b80821115612359576000816000905550600101612341565b5090565b505060608201518160030160006101000a81548160ff02191690837f0100000000000000000000000000000000000000000000000000000000000000908102040217905550905050600560008373ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006600060005481526020019081526020016000206000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060018201816001019080546001816001161561010002031660029004828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061249b57805485556124d8565b828001600101855582156124d857600052602060002091601f016020900482015b828111156124d75782548255916001019190600101906124bc565b5b5090506124fd91905b808211156124f95760008160009055506001016124e1565b5090565b505060028201816002019080546001816001161561010002031660029004828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106125545780548555612591565b8280016001018555821561259157600052602060002091601f016020900482015b82811115612590578254825591600101919060010190612575565b5b5090506125b691905b808211156125b257600081600090555060010161259a565b5090565b50506003820160009054906101000a900460ff168160030160006101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050506000600081548092919060010191905055508173ffffffffffffffffffffffffffffffffffffffff16600560008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561286757600090505b600354811015612862578173ffffffffffffffffffffffffffffffffffffffff166008600083815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156128545760606040519081016040528083815260200184815260200160018152602001506008600083815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060208201518160000160146101000a81548160ff02191690837f010000000000000000000000000000000000000000000000000000000000000090810204021790555060408201518160000160156101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050507f01eaf77f56b9b7869ab792dfca343a997e1a60b27b2a44a5e23e66fbd92d0d28600160405180821515815260200191505060405180910390a16128eb565b5b80806001019150506126a2565b6128a6565b7f01eaf77f56b9b7869ab792dfca343a997e1a60b27b2a44a5e23e66fbd92d0d28600060405180821515815260200191505060405180910390a16128eb565b6128ea565b7f01eaf77f56b9b7869ab792dfca343a997e1a60b27b2a44a5e23e66fbd92d0d28600060405180821515815260200191505060405180910390a16128eb565b5b5050505050565b6000600061290084876130d3565b801561291157506129108561372d565b5b15612b9557600560008673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020905060806040519081016040528085815260200187815260200186815260200160018152602001506007600060025481526020019081526020016000206000820151816000015560208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060408201518160020160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060608201518160020160146101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050506002600081548092919060010191905055507ffc802800e979e3cde4e3e50560d6359056315e1afcffcd5d3055c4e59a9099168382600101866040518080602001806020018481526020018381038352868181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f168015612af55780820380516001836020036101000a031916815260200191505b50838103825285818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015612b775780601f10612b4c57610100808354040283529160200191612b77565b820191906000526020600020905b815481529060010190602001808311612b5a57829003601f168201915b50509550505050505060405180910390a160019150612b9b56612b9a565b610000565b5b50949350505050565b6000600060206040519081016040528060008152602001506020604051908101604052806000815260200150600060008790505b600254811015612e7e576007600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508673ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16148015612c7757506007600082815260200190815260200160002060020160149054906101000a900460ff16155b15612e70576007600082815260200190815260200160002060000154955060046000600760008481526020019081526020016000206000015481526020019081526020016000206001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612d555780601f10612d2a57610100808354040283529160200191612d55565b820191906000526020600020905b815481529060010190602001808311612d3857829003601f168201915b50505050509350600560006007600084815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612e525780601f10612e2757610100808354040283529160200191612e52565b820191906000526020600020905b815481529060010190602001808311612e3557829003601f168201915b50505050509250600181019450858585859550955095509550612e83565b5b8080600101915050612bd8565b610000565b505092959194509250565b610640604051908101604052806032905b6000815260200190600190039081612e9f57905050610640604051908101604052806032905b6000815260200190600190039081612ec5579050506000600060006000600091505b60005482101561305d57600660008381526020019081526020016000209050600360038111610000578160030160009054906101000a900460ff166003811161000057141561304f57612fd5816001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612fcb5780601f10612fa057610100808354040283529160200191612fcb565b820191906000526020600020905b815481529060010190602001808311612fae57829003601f168201915b505050505061393a565b86846032811015610000576020020190600019169081815260200150508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168584603281101561000057602002019073ffffffffffffffffffffffffffffffffffffffff1690818152602001505082806001019350505b5b8180600101925050612ee7565b8585849550955095505b505050909192565b60086020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060000160149054906101000a900460ff16908060000160159054906101000a900460ff16905083565b60006000600560008473ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020905060008160010180546001816001161561010002031660029004905011801561314b5750600260038111610000578160030160009054906101000a900460ff166003811161000057145b156131d5578273ffffffffffffffffffffffffffffffffffffffff166004600086815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156131c757600191506131df566131d0565b600091506131df565b6131de565b600091506131df565b5b5092915050565b60066020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690806001019080600201908060030160009054906101000a900460ff16905084565b600060206040519081016040528060008152602001506020604051908101604052806000815260200150600060008690505b60015481101561346e576004600082815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508573ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16141561346057600460008281526020019081526020016000206000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156133945780601f1061336957610100808354040283529160200191613394565b820191906000526020600020905b81548152906001019060200180831161337757829003601f168201915b50505050509350600460008281526020019081526020016000206001018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156134455780601f1061341a57610100808354040283529160200191613445565b820191906000526020600020905b81548152906001019060200180831161342857829003601f168201915b50505050509250600181019450848484945094509450613473565b5b8080600101915050613273565b610000565b50509250925092565b600060006000600560008573ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002092508260010191508260020190506134c38287614208565b80156134d557506134d48186614208565b5b15613656578260030160009054906101000a900460ff16600960006101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055507f8e87a604d7135508ef70e0c10ff0fb74e4423b183de8a16b268aec8928191415600183600960009054906101000a900460ff1660038111610000578660000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16604051808515158152602001806020018481526020018373ffffffffffffffffffffffffffffffffffffffff16815260200182810382528581815460018160011615610100020316600290048152602001915080546001816001161561010002031660029004801561363c5780601f106136115761010080835404028352916020019161363c565b820191906000526020600020905b81548152906001019060200180831161361f57829003601f168201915b50509550505050505060405180910390a161372556613724565b7f8e87a604d7135508ef70e0c10ff0fb74e4423b183de8a16b268aec89281914156000876000600381116100005787604051808515158152602001806020018481526020018373ffffffffffffffffffffffffffffffffffffffff1681526020018281038252858181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561370f5780820380516001836020036101000a031916815260200191505b509550505050505060405180910390a1613725565b5b505050505050565b60006000600560008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002090506000816001018054600181600116156101000203166002900490501180156137a55750600360038111610000578160030160009054906101000a900460ff166003811161000057145b156137b757600191506137c1566137c0565b600091506137c1565b5b50919050565b600060006000600090505b60025481101561388c576007600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508373ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614801561387057506007600082815260200190815260200160002060020160149054906101000a900460ff165b1561387e5782806001019350505b5b80806001019150506137d2565b8292505b5050919050565b6004602052806000526040600020600091509050806000019080600101908060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905083565b60056020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690806001019080600201908060030160009054906101000a900460ff16905084565b6000602082015190505b919050565b610640604051908101604052806032905b600081526020019060019003908161395a57905050610640604051908101604052806032905b6000815260200190600190039081613980579050506000600060006000925060009150600090505b600354811015613b46576008600082815260200190815260200160002060000160159054906101000a900460ff161515613b3857600260038111610000576008600083815260200190815260200160002060000160149054906101000a900460ff1660038111610000571415613a8b576008600082815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168584603281101561000057602002019073ffffffffffffffffffffffffffffffffffffffff169081815260200150508280600101935050613b37565b600360038111610000576008600083815260200190815260200160002060000160149054906101000a900460ff1660038111610000571415613b36576008600082815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168483603281101561000057602002019073ffffffffffffffffffffffffffffffffffffffff1690818152602001505081806001019250505b5b5b5b80806001019150506139a8565b5b5090919293565b600060006000600090505b600154811015613be7576004600082815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508373ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff161415613bd95782806001019350505b5b8080600101915050613b59565b8292505b5050919050565b60076020528060005260406000206000915090508060000154908060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060020160149054906101000a900460ff16905084565b60206040519081016040528060008152602001506000602060405190810160405280600081526020015060006000613ca7888a6130d3565b8015613cb85750613cb78661372d565b5b156140a357600091505b60025482101561409e576007600083815260200190815260200160002090508873ffffffffffffffffffffffffffffffffffffffff168160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16148015613d435750878160000154145b8015613d9e57508573ffffffffffffffffffffffffffffffffffffffff168160020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16145b8015613db857508060020160149054906101000a900460ff165b15614090576080604051908101604052808981526020018a81526020018781526020016000815260200150600760008481526020019081526020016000206000820151816000015560208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060408201518160020160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060608201518160020160146101000a81548160ff02191690837f0100000000000000000000000000000000000000000000000000000000000000908102040217905550905050600560008773ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015613f8c5780601f10613f6157610100808354040283529160200191613f8c565b820191906000526020600020905b815481529060010190602001808311613f6f57829003601f168201915b505050505092507f2006a4633f6dc655838ce11378f6a5b94ad542f29c67b7f2c7f71833db2a5c1187846040518080602001806020018381038352858181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561401a5780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156140735780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a18688849450945094506140a9565b5b8180600101925050613cc2565b6140a8565b610000565b5b50509450945094915050565b600060006000600090505b60025481101561417a576007600082815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508373ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614801561415e57506007600082815260200190815260200160002060020160149054906101000a900460ff165b1561416c5782806001019350505b5b80806001019150506140c0565b8292505b5050919050565b60006000600560008573ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002090506000816001018054600181600116156101000203166002900490501180156141e557506141e48160010184614208565b5b156141f7576001915061420156614200565b60009150614201565b5b5092915050565b60006000602060405190810160405280600081526020015060008592508491508151838054600181600116156101000203166002900490501415156142505760009350614390565b600090505b8280546001816001161561010002031660029004905081101561438b5781818151811015610000579060200101517f010000000000000000000000000000000000000000000000000000000000000090047f0100000000000000000000000000000000000000000000000000000000000000027effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916838281546001816001161561010002031660029004811015610000578154600116156143255790600052602060002090602091828204019190065b9054901a7f0100000000000000000000000000000000000000000000000000000000000000027effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614151561437d5760009350614390565b5b8080600101915050614255565b600193505b5050509291505056', 
                 gas: '9700000'
              },function (e, contract){
                console.log(e, contract);    
                     console.log('Provider Address added: ');    
             })
          }

          for (var i = 49; i <= 50; i++) {
            contractInstance.AddAddress.sendTransaction(
              web3.eth.accounts[i],
              4,
              {
                 from: web3.eth.coinbase, 
                 data: '0x60606040523462000000576040516200489f3803806200489f833981016040528080518201919060200180518201919060200150505b6080604051908101604052803381526020018381526020018281526020016001815260200150600560003373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c010000000000000000000000009081020402179055506020820151816001019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200011b57805160ff19168380011785556200014c565b828001600101855582156200014c579182015b828111156200014b5782518255916020019190600101906200012e565b5b5090506200017491905b808211156200017057600081600090555060010162000156565b5090565b50506040820151816002019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10620001ca57805160ff1916838001178555620001fb565b82800160010185558215620001fb579182015b82811115620001fa578251825591602001919060010190620001dd565b5b5090506200022391905b808211156200021f57600081600090555060010162000205565b5090565b505060608201518160030160006101000a81548160ff02191690837f0100000000000000000000000000000000000000000000000000000000000000908102040217905550905050600560003373ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006600060005481526020019081526020016000206000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060018201816001019080546001816001161561010002031660029004828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10620003635780548555620003a3565b82800160010185558215620003a357600052602060002091601f016020900482015b82811115620003a257825482559160010191906001019062000385565b5b509050620003cb91905b80821115620003c7576000816000905550600101620003ad565b5090565b505060028201816002019080546001816001161561010002031660029004828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1062000424578054855562000464565b828001600101855582156200046457600052602060002091601f016020900482015b828111156200046357825482559160010191906001019062000446565b5b5090506200048c91905b80821115620004885760008160009055506001016200046e565b5090565b50506003820160009054906101000a900460ff168160030160006101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050506000600081548092919060010191905055505b50505b61439980620005066000396000f360606040523615610141576000357c010000000000000000000000000000000000000000000000000000000090048063068ce4a21461015357806310055c1d1461018f57806310352bc3146101ba5780631c14541b146102d6578063206565d2146104345780632368e32314610470578063306f2ff91461050a578063359a6eec146105b657806339557b011461063e5780634e5bbcba1461073d5780634e64f6bb146107a4578063598949711461080357806360c97b961461083f5780636ef76a50146109a75780636fa953da14610a9f57806385f9c74414610b4257806387b15eb614610b75578063a833b0d014610ba6578063a87430ba14610cff578063cfb5192814610e67578063e232006514610ed6578063e4e10b3614610f44578063e6b5a95e14610f75578063f237f88f14610fe9578063f74f247c1461112d575b34610000576101515b610000565b565b005b3461000057610177600480803590602001909190803590602001909190505061115e565b60405180821515815260200191505060405180910390f35b346100005761019c611570565b60405180826003811161000057815260200191505060405180910390f35b34610000576101de6004808035906020019091908035906020019091905050611583565b60405180868152602001858152602001806020018473ffffffffffffffffffffffffffffffffffffffff168152602001806020018381038352868181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561026a5780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156102c35780820380516001836020036101000a031916815260200191505b5097505050505050505060405180910390f35b34610000576102fa60048080359060200190919080359060200190919050506118ab565b604051808681526020018060200180602001806020018581526020018481038452888181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561036e5780820380516001836020036101000a031916815260200191505b508481038352878181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156103c75780820380516001836020036101000a031916815260200191505b508481038252868181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156104205780820380516001836020036101000a031916815260200191505b509850505050505050505060405180910390f35b34610000576104586004808035906020019091908035906020019091905050611cc8565b60405180821515815260200191505060405180910390f35b3461000057610508600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050611eef565b005b34610000576105b4600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001909190803590602001909190505061216e565b005b3461000057610626600480803590602001909190803590602001909190803590602001909190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919050506128f2565b60405180821515815260200191505060405180910390f35b34610000576106626004808035906020019091908035906020019091905050612ba4565b6040518085815260200184815260200180602001806020018381038352858181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156106d25780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561072b5780820380516001836020036101000a031916815260200191505b50965050505050505060405180910390f35b346100005761074a612e8e565b60405180846032602002808383829060006004602084601f0104600302600f01f150905001836032602002808383829060006004602084601f0104600302600f01f150905001828152602001935050505060405180910390f35b34610000576107bf600480803590602001909190505061306f565b604051808473ffffffffffffffffffffffffffffffffffffffff16815260200183600381116100005781526020018215158152602001935050505060405180910390f35b346100005761082760048080359060200190919080359060200190919050506130d3565b60405180821515815260200191505060405180910390f35b346100005761085a60048080359060200190919050506131e6565b604051808573ffffffffffffffffffffffffffffffffffffffff168152602001806020018060200184600381116100005781526020018381038352868181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156109115780601f106108e657610100808354040283529160200191610911565b820191906000526020600020905b8154815290600101906020018083116108f457829003601f168201915b50508381038252858181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156109945780601f1061096957610100808354040283529160200191610994565b820191906000526020600020905b81548152906001019060200180831161097757829003601f168201915b5050965050505050505060405180910390f35b34610000576109cb6004808035906020019091908035906020019091905050613241565b6040518084815260200180602001806020018381038352858181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f168015610a355780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f168015610a8e5780820380516001836020036101000a031916815260200191505b509550505050505060405180910390f35b3461000057610b40600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001909190505061347c565b005b3461000057610b5d600480803590602001909190505061372d565b60405180821515815260200191505060405180910390f35b3461000057610b9060048080359060200190919050506137c7565b6040518082815260200191505060405180910390f35b3461000057610bc16004808035906020019091905050613897565b6040518080602001806020018473ffffffffffffffffffffffffffffffffffffffff168152602001838103835286818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610c6a5780601f10610c3f57610100808354040283529160200191610c6a565b820191906000526020600020905b815481529060010190602001808311610c4d57829003601f168201915b5050838103825285818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610ced5780601f10610cc257610100808354040283529160200191610ced565b820191906000526020600020905b815481529060010190602001808311610cd057829003601f168201915b50509550505050505060405180910390f35b3461000057610d1a60048080359060200190919050506138df565b604051808573ffffffffffffffffffffffffffffffffffffffff16815260200180602001806020018460038111610000578152602001838103835286818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610dd15780601f10610da657610100808354040283529160200191610dd1565b820191906000526020600020905b815481529060010190602001808311610db457829003601f168201915b5050838103825285818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610e545780601f10610e2957610100808354040283529160200191610e54565b820191906000526020600020905b815481529060010190602001808311610e3757829003601f168201915b5050965050505050505060405180910390f35b3461000057610ebc600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190505061393a565b604051808260001916815260200191505060405180910390f35b3461000057610ee3613949565b60405180856032602002808383829060006004602084601f0104600302600f01f150905001846032602002808383829060006004602084601f0104600302600f01f15090500183815260200182815260200194505050505060405180910390f35b3461000057610f5f6004808035906020019091905050613b4e565b6040518082815260200191505060405180910390f35b3461000057610f906004808035906020019091905050613bf2565b604051808581526020018473ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff168152602001821515815260200194505050505060405180910390f35b3461000057611059600480803590602001909190803590602001909190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091908035906020019091905050613c6f565b6040518080602001848152602001806020018381038352868181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156110c35780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561111c5780820380516001836020036101000a031916815260200191505b509550505050505060405180910390f35b346100005761114860048080359060200190919050506140b5565b6040518082815260200191505060405180910390f35b60006000600060006000600460008881526020019081526020016000209350600092508573ffffffffffffffffffffffffffffffffffffffff168460020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561152457600090505b6002548110156113ca576007600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508173ffffffffffffffffffffffffffffffffffffffff168673ffffffffffffffffffffffffffffffffffffffff161480156112715750866007600083815260200190815260200160002060000154145b156113bc576007600082815260200190815260200160002060020160149054906101000a900460ff16156112e4577fe1fab20581d179581fe822eeb7db36e3a12e539dbf04fb0b6fbd755639e017348360405180821515815260200191505060405180910390a1829450611566566113bb565b60076000828152602001908152602001600020600060008201600090556001820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556002820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556002820160146101000a81549060ff021916905550506001925060026000815460019003919050819055507fe1fab20581d179581fe822eeb7db36e3a12e539dbf04fb0b6fbd755639e017348360405180821515815260200191505060405180910390a1829450611566565b5b5b80806001019150506111de565b60046000888152602001908152602001600020600060008201805460018160011615610100020316600290046000825580601f10611408575061143f565b601f01602090049060005260206000209081019061143e91905b8082111561143a576000816000905550600101611422565b5090565b5b5060018201805460018160011615610100020316600290046000825580601f1061146957506114a0565b601f01602090049060005260206000209081019061149f91905b8082111561149b576000816000905550600101611483565b5090565b5b506002820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff021916905550506001600081546001900391905081905550600192507fe1fab20581d179581fe822eeb7db36e3a12e539dbf04fb0b6fbd755639e017348360405180821515815260200191505060405180910390a182945061156656611565565b7fe1fab20581d179581fe822eeb7db36e3a12e539dbf04fb0b6fbd755639e017348360405180821515815260200191505060405180910390a1829450611566565b5b5050505092915050565b600960009054906101000a900460ff1681565b60006000602060405190810160405280600081526020015060006020604051908101604052806000815260200150600060008890505b60025481101561189a576007600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508773ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614801561165757506007600082815260200190815260200160002060020160149054906101000a900460ff165b1561188c576007600082815260200190815260200160002060000154965060046000600760008481526020019081526020016000206000015481526020019081526020016000206001018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156117355780601f1061170a57610100808354040283529160200191611735565b820191906000526020600020905b81548152906001019060200180831161171857829003601f168201915b505050505094506007600082815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169350600560006007600084815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561186b5780601f106118405761010080835404028352916020019161186b565b820191906000526020600020905b81548152906001019060200180831161184e57829003601f168201915b5050505050925060018101955086868686869650965096509650965061189f565b5b80806001019150506115b9565b610000565b50509295509295909350565b600060206040519081016040528060008152602001506020604051908101604052806000815260200150602060405190810160405280600081526020015060006000600060008891505b600254821015611cb6576007600083815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1692508973ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614801561199357506007600083815260200190815260200160002060020160149054906101000a900460ff165b15611ca857600460006007600085815260200190815260200160002060000154815260200190815260200160002090506007600083815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168160020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415611ca757819350600760008381526020019081526020016000206000015481600101600560008460020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018360000187838054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611b595780601f10611b2e57610100808354040283529160200191611b59565b820191906000526020600020905b815481529060010190602001808311611b3c57829003601f168201915b50505050509350828054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611bf55780601f10611bca57610100808354040283529160200191611bf5565b820191906000526020600020905b815481529060010190602001808311611bd857829003601f168201915b50505050509250818054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611c915780601f10611c6657610100808354040283529160200191611c91565b820191906000526020600020905b815481529060010190602001808311611c7457829003601f168201915b5050505050915097509750975097509750611cbb565b5b5b81806001019250506118f5565b610000565b5050509295509295909350565b60006000600090505b600354811015611d96578373ffffffffffffffffffffffffffffffffffffffff166008600083815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415611d88577f63a5eccd848f95f4a09b1d48db73ca4c5202ce7dcf8c10113549d7612f59ec86600060405180821515815260200191505060405180910390a160009150611ee8565b5b8080600101915050611cd1565b606060405190810160405280858152602001848152602001600081526020015060086000600354815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060208201518160000160146101000a81548160ff02191690837f010000000000000000000000000000000000000000000000000000000000000090810204021790555060408201518160000160156101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050506003600081548092919060010191905055507f63a5eccd848f95f4a09b1d48db73ca4c5202ce7dcf8c10113549d7612f59ec86600160405180821515815260200191505060405180910390a1600191505b5092915050565b6000606060405190810160405280848152602001838152602001338152602001506004600060015481526020019081526020016000206000820151816000019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10611f7757805160ff1916838001178555611fa5565b82800160010185558215611fa5579182015b82811115611fa4578251825591602001919060010190611f89565b5b509050611fca91905b80821115611fc6576000816000905550600101611fae565b5090565b50506020820151816001019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061201e57805160ff191683800117855561204c565b8280016001018555821561204c579182015b8281111561204b578251825591602001919060010190612030565b5b50905061207191905b8082111561206d576000816000905550600101612055565b5090565b505060408201518160020160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c01000000000000000000000000908102040217905550905050600160008154809291906001019190505550600190507f4d4b9742a60461b9030134e4544ec7e538062d9be5beeefdf073d68840ee67868282604051808060200183151581526020018281038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561215a5780820380516001836020036101000a031916815260200191505b50935050505060405180910390a15b505050565b600061217a8286614185565b15156128ab5760806040519081016040528083815260200186815260200185815260200184815260200150600560008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c010000000000000000000000009081020402179055506020820151816001019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061226357805160ff1916838001178555612291565b82800160010185558215612291579182015b82811115612290578251825591602001919060010190612275565b5b5090506122b691905b808211156122b257600081600090555060010161229a565b5090565b50506040820151816002019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061230a57805160ff1916838001178555612338565b82800160010185558215612338579182015b8281111561233757825182559160200191906001019061231c565b5b50905061235d91905b80821115612359576000816000905550600101612341565b5090565b505060608201518160030160006101000a81548160ff02191690837f0100000000000000000000000000000000000000000000000000000000000000908102040217905550905050600560008373ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006600060005481526020019081526020016000206000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060018201816001019080546001816001161561010002031660029004828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061249b57805485556124d8565b828001600101855582156124d857600052602060002091601f016020900482015b828111156124d75782548255916001019190600101906124bc565b5b5090506124fd91905b808211156124f95760008160009055506001016124e1565b5090565b505060028201816002019080546001816001161561010002031660029004828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106125545780548555612591565b8280016001018555821561259157600052602060002091601f016020900482015b82811115612590578254825591600101919060010190612575565b5b5090506125b691905b808211156125b257600081600090555060010161259a565b5090565b50506003820160009054906101000a900460ff168160030160006101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050506000600081548092919060010191905055508173ffffffffffffffffffffffffffffffffffffffff16600560008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561286757600090505b600354811015612862578173ffffffffffffffffffffffffffffffffffffffff166008600083815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156128545760606040519081016040528083815260200184815260200160018152602001506008600083815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060208201518160000160146101000a81548160ff02191690837f010000000000000000000000000000000000000000000000000000000000000090810204021790555060408201518160000160156101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050507f01eaf77f56b9b7869ab792dfca343a997e1a60b27b2a44a5e23e66fbd92d0d28600160405180821515815260200191505060405180910390a16128eb565b5b80806001019150506126a2565b6128a6565b7f01eaf77f56b9b7869ab792dfca343a997e1a60b27b2a44a5e23e66fbd92d0d28600060405180821515815260200191505060405180910390a16128eb565b6128ea565b7f01eaf77f56b9b7869ab792dfca343a997e1a60b27b2a44a5e23e66fbd92d0d28600060405180821515815260200191505060405180910390a16128eb565b5b5050505050565b6000600061290084876130d3565b801561291157506129108561372d565b5b15612b9557600560008673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020905060806040519081016040528085815260200187815260200186815260200160018152602001506007600060025481526020019081526020016000206000820151816000015560208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060408201518160020160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060608201518160020160146101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055509050506002600081548092919060010191905055507ffc802800e979e3cde4e3e50560d6359056315e1afcffcd5d3055c4e59a9099168382600101866040518080602001806020018481526020018381038352868181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f168015612af55780820380516001836020036101000a031916815260200191505b50838103825285818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015612b775780601f10612b4c57610100808354040283529160200191612b77565b820191906000526020600020905b815481529060010190602001808311612b5a57829003601f168201915b50509550505050505060405180910390a160019150612b9b56612b9a565b610000565b5b50949350505050565b6000600060206040519081016040528060008152602001506020604051908101604052806000815260200150600060008790505b600254811015612e7e576007600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508673ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16148015612c7757506007600082815260200190815260200160002060020160149054906101000a900460ff16155b15612e70576007600082815260200190815260200160002060000154955060046000600760008481526020019081526020016000206000015481526020019081526020016000206001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612d555780601f10612d2a57610100808354040283529160200191612d55565b820191906000526020600020905b815481529060010190602001808311612d3857829003601f168201915b50505050509350600560006007600084815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612e525780601f10612e2757610100808354040283529160200191612e52565b820191906000526020600020905b815481529060010190602001808311612e3557829003601f168201915b50505050509250600181019450858585859550955095509550612e83565b5b8080600101915050612bd8565b610000565b505092959194509250565b610640604051908101604052806032905b6000815260200190600190039081612e9f57905050610640604051908101604052806032905b6000815260200190600190039081612ec5579050506000600060006000600091505b60005482101561305d57600660008381526020019081526020016000209050600360038111610000578160030160009054906101000a900460ff166003811161000057141561304f57612fd5816001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612fcb5780601f10612fa057610100808354040283529160200191612fcb565b820191906000526020600020905b815481529060010190602001808311612fae57829003601f168201915b505050505061393a565b86846032811015610000576020020190600019169081815260200150508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168584603281101561000057602002019073ffffffffffffffffffffffffffffffffffffffff1690818152602001505082806001019350505b5b8180600101925050612ee7565b8585849550955095505b505050909192565b60086020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060000160149054906101000a900460ff16908060000160159054906101000a900460ff16905083565b60006000600560008473ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020905060008160010180546001816001161561010002031660029004905011801561314b5750600260038111610000578160030160009054906101000a900460ff166003811161000057145b156131d5578273ffffffffffffffffffffffffffffffffffffffff166004600086815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156131c757600191506131df566131d0565b600091506131df565b6131de565b600091506131df565b5b5092915050565b60066020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690806001019080600201908060030160009054906101000a900460ff16905084565b600060206040519081016040528060008152602001506020604051908101604052806000815260200150600060008690505b60015481101561346e576004600082815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508573ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16141561346057600460008281526020019081526020016000206000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156133945780601f1061336957610100808354040283529160200191613394565b820191906000526020600020905b81548152906001019060200180831161337757829003601f168201915b50505050509350600460008281526020019081526020016000206001018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156134455780601f1061341a57610100808354040283529160200191613445565b820191906000526020600020905b81548152906001019060200180831161342857829003601f168201915b50505050509250600181019450848484945094509450613473565b5b8080600101915050613273565b610000565b50509250925092565b600060006000600560008573ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002092508260010191508260020190506134c38287614208565b80156134d557506134d48186614208565b5b15613656578260030160009054906101000a900460ff16600960006101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055507f8e87a604d7135508ef70e0c10ff0fb74e4423b183de8a16b268aec8928191415600183600960009054906101000a900460ff1660038111610000578660000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16604051808515158152602001806020018481526020018373ffffffffffffffffffffffffffffffffffffffff16815260200182810382528581815460018160011615610100020316600290048152602001915080546001816001161561010002031660029004801561363c5780601f106136115761010080835404028352916020019161363c565b820191906000526020600020905b81548152906001019060200180831161361f57829003601f168201915b50509550505050505060405180910390a161372556613724565b7f8e87a604d7135508ef70e0c10ff0fb74e4423b183de8a16b268aec89281914156000876000600381116100005787604051808515158152602001806020018481526020018373ffffffffffffffffffffffffffffffffffffffff1681526020018281038252858181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561370f5780820380516001836020036101000a031916815260200191505b509550505050505060405180910390a1613725565b5b505050505050565b60006000600560008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002090506000816001018054600181600116156101000203166002900490501180156137a55750600360038111610000578160030160009054906101000a900460ff166003811161000057145b156137b757600191506137c1566137c0565b600091506137c1565b5b50919050565b600060006000600090505b60025481101561388c576007600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508373ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614801561387057506007600082815260200190815260200160002060020160149054906101000a900460ff165b1561387e5782806001019350505b5b80806001019150506137d2565b8292505b5050919050565b6004602052806000526040600020600091509050806000019080600101908060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905083565b60056020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690806001019080600201908060030160009054906101000a900460ff16905084565b6000602082015190505b919050565b610640604051908101604052806032905b600081526020019060019003908161395a57905050610640604051908101604052806032905b6000815260200190600190039081613980579050506000600060006000925060009150600090505b600354811015613b46576008600082815260200190815260200160002060000160159054906101000a900460ff161515613b3857600260038111610000576008600083815260200190815260200160002060000160149054906101000a900460ff1660038111610000571415613a8b576008600082815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168584603281101561000057602002019073ffffffffffffffffffffffffffffffffffffffff169081815260200150508280600101935050613b37565b600360038111610000576008600083815260200190815260200160002060000160149054906101000a900460ff1660038111610000571415613b36576008600082815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168483603281101561000057602002019073ffffffffffffffffffffffffffffffffffffffff1690818152602001505081806001019250505b5b5b5b80806001019150506139a8565b5b5090919293565b600060006000600090505b600154811015613be7576004600082815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508373ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff161415613bd95782806001019350505b5b8080600101915050613b59565b8292505b5050919050565b60076020528060005260406000206000915090508060000154908060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060020160149054906101000a900460ff16905084565b60206040519081016040528060008152602001506000602060405190810160405280600081526020015060006000613ca7888a6130d3565b8015613cb85750613cb78661372d565b5b156140a357600091505b60025482101561409e576007600083815260200190815260200160002090508873ffffffffffffffffffffffffffffffffffffffff168160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16148015613d435750878160000154145b8015613d9e57508573ffffffffffffffffffffffffffffffffffffffff168160020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16145b8015613db857508060020160149054906101000a900460ff165b15614090576080604051908101604052808981526020018a81526020018781526020016000815260200150600760008481526020019081526020016000206000820151816000015560208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060408201518160020160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555060608201518160020160146101000a81548160ff02191690837f0100000000000000000000000000000000000000000000000000000000000000908102040217905550905050600560008773ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015613f8c5780601f10613f6157610100808354040283529160200191613f8c565b820191906000526020600020905b815481529060010190602001808311613f6f57829003601f168201915b505050505092507f2006a4633f6dc655838ce11378f6a5b94ad542f29c67b7f2c7f71833db2a5c1187846040518080602001806020018381038352858181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561401a5780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156140735780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a18688849450945094506140a9565b5b8180600101925050613cc2565b6140a8565b610000565b5b50509450945094915050565b600060006000600090505b60025481101561417a576007600082815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1691508373ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614801561415e57506007600082815260200190815260200160002060020160149054906101000a900460ff165b1561416c5782806001019350505b5b80806001019150506140c0565b8292505b5050919050565b60006000600560008573ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002090506000816001018054600181600116156101000203166002900490501180156141e557506141e48160010184614208565b5b156141f7576001915061420156614200565b60009150614201565b5b5092915050565b60006000602060405190810160405280600081526020015060008592508491508151838054600181600116156101000203166002900490501415156142505760009350614390565b600090505b8280546001816001161561010002031660029004905081101561438b5781818151811015610000579060200101517f010000000000000000000000000000000000000000000000000000000000000090047f0100000000000000000000000000000000000000000000000000000000000000027effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916838281546001816001161561010002031660029004811015610000578154600116156143255790600052602060002090602091828204019190065b9054901a7f0100000000000000000000000000000000000000000000000000000000000000027effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614151561437d5760009350614390565b5b8080600101915050614255565b600193505b5050509291505056', 
                 gas: '9700000'
              },function (e, contract){
                console.log(e, contract);    
                     console.log('Contract Address added: ');    
             })
          }

          console.log("Reset is triggerred");
          res.status(200).send({Info: "Reset is triggerred"});
        }
      });
  });  

});

/*
app.get('/share/GetAllFiles',jsonparser,function(req,res)
{
  var address = req.query.address;
  var fileIndex = 0;
  var sharedFileIndex = 0;
  var filecontent,fileName;
  var fileArr = new Array();
  var fileInfo;
  var sharedProviderAddr;
  var sharedFileArr = new Array();
  var FileId = 0;
  var sharedFileInfo;
    
  var uploadedFileCount = contractInstance.getUserFileCount.call(address);
  console.log("uploadedFileCount" + uploadedFileCount);

  for(var i=0; i<uploadedFileCount;i++)
  {
    var uploadedFiles = contractInstance.getFileDetails.call(fileIndex,address);              
    fileIndex = uploadedFiles[0];
    filecontent = uploadedFiles[1];
    fileName = uploadedFiles[2];
    fileInfo = {id:fileIndex-1, hash:filecontent, name:fileName, provider:"", providerAddress:""};
    fileArr.push(fileInfo);
  }
  
  var sharedFileCount = contractInstance.GetSharedFileCount.call(address);
  console.log("sharedFileCount" + sharedFileCount);
  for(var i=0; i<sharedFileCount;i++)
  {
    var sharedFiles = contractInstance.GetUserSharedFiles.call(sharedFileIndex,address);  
    console.log("shared file details" + sharedFiles);       
    FileId = sharedFiles[0];
    sharedFileIndex = sharedFiles[1];
    fileName = sharedFiles[2];
    sharedProviderAddr = sharedFiles[3];
    sharedProvider = sharedFiles[4];
    sharedFileInfo = {id:FileId, name:fileName, provider:sharedProvider, providerAddr: sharedProviderAddr};
    sharedFileArr.push(sharedFileInfo); 
  }


  for(var count=0;count<fileArr.length;count++)
  {
    
    for(var scount=0;scount<sharedFileArr.length;scount++)
    {
      console.log("Filelist name " + fileArr[count].name);
      console.log("shared Filelist name " + sharedFileArr[scount].name);
      console.log("sharedFileArr[scount].providerAddr " + sharedFileArr[scount].providerAddr);
      
      if(fileArr[count].id==sharedFileArr[scount].id && fileArr[count].name==sharedFileArr[scount].name)
      {
        fileArr[count].providerAddress = sharedFileArr[scount].providerAddr;
        fileArr[count].provider = sharedFileArr[scount].provider;
      }
    }
  }

  res.json({UploadedFiles:fileArr});
  
});
*/


app.get('/share/GetAllFiles',jsonparser,function(req,res)
{
  try{


      var address = req.query.address;
      var fileIndex = 0;
      var sharedFileIndex = 0;
      var filecontent,fileName;
      var fileArr = new Array();
      var fileInfo;
      var sharedProviderAddr;
      var sharedFileArr = new Array();
      var FileId = 0;
      var sharedFileInfo;
        
      var uploadedFileCount = contractInstance.getUserFileCount.call(address);
      console.log("uploadedFileCount" + uploadedFileCount);

      for(var i=0; i<uploadedFileCount;i++)
      {
        var uploadedFiles = contractInstance.getFileDetails.call(fileIndex,address);              
        fileIndex = uploadedFiles[0];
        filecontent = uploadedFiles[1];
        fileName = uploadedFiles[2];
        fileInfo = {id:fileIndex-1, hash:filecontent, name:fileName, providerlist: new Array()};
        fileArr.push(fileInfo);
      }
      
      var sharedFileCount = contractInstance.GetSharedFileCount.call(address);
      console.log("sharedFileCount" + sharedFileCount);
      for(var i=0; i<sharedFileCount;i++)
      {
        var sharedFiles = contractInstance.GetUserSharedFiles.call(sharedFileIndex,address);  
        console.log("shared file details" + sharedFiles);       
        FileId = sharedFiles[0];
        sharedFileIndex = sharedFiles[1];
        fileName = sharedFiles[2];
        sharedProviderAddr = sharedFiles[3];
        sharedProvider = sharedFiles[4];
        sharedTimeStamp = sharedFiles[5];
        sharedFileInfo = {id:FileId, name:fileName, provider:sharedProvider, providerAddr: sharedProviderAddr, timeStamp: sharedTimeStamp};
        sharedFileArr.push(sharedFileInfo); 
      }


      for(var count=0;count<fileArr.length;count++)
      {
        
        for(var scount=0;scount<sharedFileArr.length;scount++)
        {
          console.log("Filelist name " + fileArr[count].name);
          console.log("shared Filelist name " + sharedFileArr[scount].name);
          console.log("sharedFileArr[scount].providerAddr " + sharedFileArr[scount].providerAddr);
          
          if(fileArr[count].id==sharedFileArr[scount].id && fileArr[count].name==sharedFileArr[scount].name)
          {
            console.log("adding provider for the upload file");
            providerInfo = {provider:sharedFileArr[scount].provider, providerAddress:sharedFileArr[scount].providerAddr, timeStamp: sharedFileArr[scount].timeStamp} 
            fileArr[count].providerlist.push(providerInfo);            
          }
        }
      }

      res.json({UploadedFiles:fileArr});
  }
  catch (ex){
    console.log ("Exception in Getfiles2 method:" + ex);
    res.status(500).send({error: ex}); 
  }
  
});


app.get('/Provider/GetFiles',jsonparser,function(req,res)
{
  try
  {
    console.log ("Provider/GetFiles is called");
    var FileId;
    var FileIndex = 0;
    var fileName,fileHash;
    var owner;
    var sharedFileArr = new Array();
    var sharedFileInfo;
    console.log("Request query address :" + req.query.address)
    var address = req.query.address;

    var providerFiles = contractInstance.GetProviderFileCount.call(address);  
    
    console.log("ProvidersFileCount response:" + providerFiles);

    for(var i=0; i<providerFiles;i++)
    {
      try{
        var result = contractInstance.GetProviderFiles.call(address,FileIndex);
        console.log("Getfiles:" + result);
        console.log("GetProviderFiles response:" + result[0] + result[1] + result[5]);
        FileId = result[0];
        fileName = result[1];
        owner = result[2];
        fileHash = result[3];
        FileIndex = parseInt(result[4])+1;
        timeStamp = result[5]
        sharedFileInfo = {id:FileId, name:fileName, owner:owner, hash: fileHash, time: timeStamp };
        sharedFileArr.push(sharedFileInfo);  
      }
      catch (ex){
        FileIndex++;
        console.log("Contract error GetProviderFiles:" + ex);
      }

    }
    
    res.json({Files:sharedFileArr});
  }
  catch (ex){
    console.log ("Exception in Getfiles method:" + ex);
    res.status(500).send({error: ex}); 
  }

});

app.get('/share/GetRevokedFiles',jsonparser,function(req,res)
{
    var FileId;
    var FileIndex = 0;
    var fileName;
    var providerName;
    var revokedFileArr = new Array();
    var revokedFileInfo;

    var address = req.query.address;

    var uploadedFiles = contractInstance.getUserFileCount.call(address);  
    for(var i=0; i<uploadedFiles;i++)
    {
      var result = contractInstance.GetUserRevokedFiles.call(FileIndex,address); 
      FileId = result[0];
      FileIndex = result[1];
      fileName = result[2];
      providerName = result[3];
    
      revokedFileInfo = {id:FileId, name:fileName, provider:providerName};
      revokedFileArr.push(revokedFileInfo);
    }
    res.json({RevokedFiles:revokedFileArr});
});

app.post('/share',jsonparser,function(req,res){

      var fileName = req.body.fileName;
      var ownerAddress = req.body.address;
      var providerAddress = req.body.providerAddress;
      var fileId = req.body.fileId;

      var dt = new Date();
      var timeStamp = dt.toUTCString();
      
      var transactionObject = {
            data: bytecode,
            from: ownerAddress,
            gasPrice: web3.eth.gasPrice,
            gas: const_gas
      };

      web3.eth.estimateGas(transactionObject, function(err, estimateGas){
        if(!err)
          transactionObject.gas = estimateGas * const_gasMultiplierFactor;
          contractInstance.ShareFiles.sendTransaction(ownerAddress,providerAddress,fileId,fileName,timeStamp,transactionObject, function(err,result){

          if(err){
            console.log(err)
            res.status(500).send({error: err.toString()}); 
          }
          else
          {
            var loggedEvent = contractInstance.FileShared();
            loggedEvent.watch(function(error, result) {
            if (error) {
              console.log(error.toString())
              res.status(500).send({error: error.toString()}); 
            }
            else
            {
              if(result.args.FileName.length > 0) {
                loggedEvent.stopWatching();
                res.status(200).send(result.args.FileName + " shared with " + result.args.userName);                
              }
              else{
                loggedEvent.stopWatching();
                res.status(500).send({error: "Returns no filename from contract"});                
              }
              
            }

            });
          }

        })
      })
});


app.post('/delete',jsonparser,function(req,res){

      var ownerAddress = req.body.address;
      var fileId = req.body.fileId;
      
      var transactionObject = {
            data: bytecode,
            from: ownerAddress,
            gasPrice: web3.eth.gasPrice,
            gas: const_gas
      };

      web3.eth.estimateGas(transactionObject, function(err, estimateGas){
        if(!err)
          transactionObject.gas = estimateGas * const_gasMultiplierFactor;
          
          contractInstance.RemoveFile.sendTransaction(fileId,ownerAddress,transactionObject, function(err,result){

          if(err){
            console.log(err)
            res.status(500).send({error: err.toString()}); 
          }
          else
          {
            var loggedEvent = contractInstance.FileDeleted();  
            loggedEvent.watch(function(error, result) {
            if (error) {
              console.log(error.toString())
              res.status(500).send({error: error.toString()}); 
            }
            else
            {
              if(result.args.deleted) {
                loggedEvent.stopWatching();
                console.log("deleted")
                res.end();
              }
              else{
                loggedEvent.stopWatching();
                console.log("error deleting")
                res.status(400).send({error: "Error Deleting file."});                 
              }
              
            }

            });
          }

        })
      })
});


app.post('/revoke',jsonparser,function(req,res){

      var fileName = req.body.fileName;
      var ownerAddress = req.body.address;
      var providerAddress = req.body.providerAddress;
      var fileId = req.body.fileId;
      
      var transactionObject = {
            data: bytecode,
            from: ownerAddress,
            gasPrice: web3.eth.gasPrice,
            gas: const_gas
      };

      web3.eth.estimateGas(transactionObject, function(err, estimateGas){
        if(!err)
          transactionObject.gas = estimateGas * const_gasMultiplierFactor;
        console.log("RevokeFileaccess is to called");
        contractInstance.RevokeFileAccess.sendTransaction(ownerAddress,fileId,fileName,providerAddress,transactionObject, function(err,result){

          if(err){
            console.log(err)
            //res.json({error:err})            
            res.status(500).send({error: err.toString()});
          }
          else
          {
            
            var loggedEvent = contractInstance.FileAccessRevoked();
            loggedEvent.watch(function(error, result) {
              console.log("Fileaccessrovoked >> Watch the loggedEvent");
              if (error) {
                console.log(error.toString());
                res.status(500).send({error: error.toString()});
              }
              else
              {                
                if(result.args.fileName.length > 0) {
                  loggedEvent.stopWatching();
                  res.end();
                }
                else{
                  loggedEvent.stopWatching();
                  console.log("There are no files to revoke access");
                  res.status(500).send({error: "Error revoking file access."});
                }                
              }

              });
        }

        })
      })
});

app.listen(config.get('port'), function () {

console.log(config.get('env') + 'Node server started!')
})